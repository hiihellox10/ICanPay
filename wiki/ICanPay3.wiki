#labels 更多的其他问题
= 更多的其他问题 =

这里将对前面的一些没有讲述的问题做补充。


  * 提交、查询订单，网关返回通知时更多其他的数据保存在哪里
  * 网关通知的确认
  * 订单编号的建议

----



== 提交、查询订单，网关返回通知时更多其他的数据保存在哪里 ==

在ICanPay的PayGateway中只提供了Customer、Merchant、Order3个常用属性，而更多的需要传递的值。我们推荐使用OtherData["key"]这种类型来传递，或者你也可以在网关的实现中加入新的属性。

  ==== 接收到的网关通知更多的数据在哪里 ====

在ICanPay中是使用PayGateway的OtherData来保存PayGateway中没有提供的其他数据。

为了便于使用。例如在正确接收到的网关的通知后，在已有的4个实现中，只有Order属性赋给了接收到的订单金额跟订单编号。如果你想处理其他的网关数据，比如网关通知中可能包含了付款时间、网关的订单编号。如果你需要这些数据，可以参照网关文档使用PayGateway.OtherData["key"]来获取相应的值。


  ==== 订单的查询需要日期或其他数据 ====

在ICanPay的PayGateway中没有提供日期属性，而对于一些网关的订单查询可能除了订单编号以外还需要订单日期或者其他数据。例如财付通TenPay的查询需要提供日期，这时我们建议可以通过PayGateway.OtherData["data"]这种类型来传递需要的参数，或者你也可以在网关的实现中加入新的属性。

在TenPay的查询中，你除了提供必须的Merchant、Order属性。你还需要这样来传递需要的data属性。
{{{
ps.PayGateway.OtherData["data"] = "20080101";
}}}


----

== 网关通知的确认 ==

大部分网关都需要在接收到网关通知后，在接受通知的页面用输入字符串的形式来通知网关，已接受到通知不用再次发送。

各个不同的网关在这里的要求不同，例如财付通Tenpay要求接受的页面必须包含 <meta name="TENCENT_ONELINE_PAYMENT" content="China TENCENT"> 标识，如果没有的话用户的付款后就不能跳转到商户的页面。不过对付款没有影响，这方便请浏览各个网关的文档。


----

== 订单编号的建议 ==

国内网上支付网关只有少数在订单的编号上可以使用任意字符，而有的限制为只能使用数字或者数字+英文字符，而有的网关在订单的编号上有严格限制，必须按照规定顺序来产生订单编号。

如果你需要能够同时使用多家网关支付，那么你在订单编号的生成上保持只使用数字编号的订单。